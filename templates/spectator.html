<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Spectator ‚Äî Admiral Radar</title>
  <link rel="stylesheet" href="/static/css/base.css"/>
  <link rel="stylesheet" href="/static/css/spectator.css"/>
</head>
<body class="spec-body">

<div class="spec-layout">

  <!-- ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <header class="spec-header">
    <span class="spec-title">üëÅ SPECTATING</span>
    <span class="spec-code">{{ game_id }}</span>
    <div class="spec-turn-badge" id="spec-turn">WAITING</div>
    <div class="spec-status" id="spec-status">Connecting‚Ä¶</div>
    <span class="spec-name">{{ player_name }}</span>
  </header>

  <!-- ‚îÄ‚îÄ MAIN: blue panel | map | red panel ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="spec-main">

    <!-- BLUE TEAM PANEL -->
    <div class="spec-team-panel spec-blue">
      <div class="stp-title blue">üîµ BLUE TEAM</div>
      <div class="stp-section">
        <div class="section-label">HULL</div>
        <div class="health-row fixed-health" id="blue-health"></div>
      </div>
      <div class="stp-section">
        <div class="section-label">SYSTEMS</div>
        <div id="blue-systems"></div>
      </div>
      <div class="stp-section">
        <div class="section-label">POWER GRID</div>
        <div id="blue-eng"></div>
      </div>
      <div class="stp-surfaced" id="blue-surfaced">‚ö† SURFACED</div>
      <div class="stp-section stp-moves">
        <div class="section-label">MOVE LOG</div>
        <div class="move-log" id="blue-moves"></div>
      </div>
    </div>

    <!-- MAP CENTER -->
    <div class="spec-map-area">
      <div class="map-wrapper" id="spec-wrapper" style="position:relative;display:inline-block">
        <div id="spec-map" class="map-grid"></div>
        <!-- SVG: ships, trails, mines -->
        <svg id="spec-svg" style="position:absolute;top:0;left:0;pointer-events:none;overflow:visible;z-index:2;"></svg>
        <!-- Radio operator drawing layers (one per team, no pointer-events) -->
        <canvas id="ro-canvas-blue" style="position:absolute;top:0;left:0;pointer-events:none;z-index:3;opacity:0.75;"></canvas>
        <canvas id="ro-canvas-red"  style="position:absolute;top:0;left:0;pointer-events:none;z-index:3;opacity:0.75;"></canvas>
      </div>
    </div>

    <!-- RED TEAM PANEL -->
    <div class="spec-team-panel spec-red">
      <div class="stp-title red">üî¥ RED TEAM</div>
      <div class="stp-section">
        <div class="section-label">HULL</div>
        <div class="health-row fixed-health" id="red-health"></div>
      </div>
      <div class="stp-section">
        <div class="section-label">SYSTEMS</div>
        <div id="red-systems"></div>
      </div>
      <div class="stp-section">
        <div class="section-label">POWER GRID</div>
        <div id="red-eng"></div>
      </div>
      <div class="stp-surfaced" id="red-surfaced">‚ö† SURFACED</div>
      <div class="stp-section stp-moves">
        <div class="section-label">MOVE LOG</div>
        <div class="move-log" id="red-moves"></div>
      </div>
    </div>

  </div><!-- /spec-main -->

  <!-- ‚îÄ‚îÄ BOTTOM LOG ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="spec-log-bar">
    <div class="spec-log-label">COMMS LOG</div>
    <div class="spec-event-log" id="spec-event-log"></div>
  </div>

</div><!-- /spec-layout -->

<div id="result-toast" class="result-toast hidden"></div>

<script>
  const GAME_ID    = "{{ game_id }}";
  const MY_NAME    = "{{ player_name }}";
  const MAP_ROWS   = {{ map_rows }};
  const MAP_COLS   = {{ map_cols }};
  const SECTOR_SZ  = {{ sector_size }};
  const ISLANDS    = {{ islands | tojson }};
  const COL_LABELS = {{ col_labels | tojson }};
</script>
<script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
<script src="/static/js/spectator.js"></script>
</body>
</html>
